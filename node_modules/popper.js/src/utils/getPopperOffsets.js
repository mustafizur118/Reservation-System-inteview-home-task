import getOuterSizes from './getOuterSizes';
import getOppositePlacement from './getOppositePlacement';


export default function getPopperOffsets(popper, referenceOffsets, placement) {
  placement = placement.split('-')[0];

  
  const popperRect = getOuterSizes(popper);

  
  const popperOffsets = {
    width: popperRect.width,
    height: popperRect.height,
  };

  
  const isHoriz = ['right', 'left'].indexOf(placement) !== -1;
  const mainSide = isHoriz ? 'top' : 'left';
  const secondarySide = isHoriz ? 'left' : 'top';
  const measurement = isHoriz ? 'height' : 'width';
  const secondaryMeasurement = !isHoriz ? 'height' : 'width';

  popperOffsets[mainSide] =
    referenceOffsets[mainSide] +
    referenceOffsets[measurement] / 2 -
    popperRect[measurement] / 2;
  if (placement === secondarySide) {
    popperOffsets[secondarySide] =
      referenceOffsets[secondarySide] - popperRect[secondaryMeasurement];
  } else {
    popperOffsets[secondarySide] =
      referenceOffsets[getOppositePlacement(secondarySide)];
  }

  return popperOffsets;
}
